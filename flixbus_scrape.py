from requests_html import HTMLSession
# https://shop.flixbus.cz/search?departureCity=40d8f682-8646-11e6-9066-549f350fcb0c&arrivalCity=40d91e53-8646-11e6-9066-549f350fcb0c&route=Berl%C3%ADn-Hamburk&rideDate=22.05.2021&adult=1&_locale=cs&features%5Bfeature.darken_page%5D=1&features%5Bfeature.enable_distribusion%5D=1&_sp=08b1834a-428c-4efb-84cd-d34b2813335d#

def flixbus_scrape(source, destination, departure_date):
    session = HTMLSession()
    url_flixbus = session.get(f'https://shop.flixbus.cz/search?departureCity=40d8f682-8646-11e6-9066-549f350fcb0c&arrivalCity=40d91e53-8646-11e6-9066-549f350fcb0c&route={source}-{destination}&rideDate={departure_date}&adult=1&_locale=cs&features%5Bfeature.darken_page%5D=1&features%5Bfeature.enable_distribusion%5D=1&_sp=08b1834a-428c-4efb-84cd-d34b2813335d#')
    url_flixbus.html.render()
    connections = url_flixbus.html.find('.ResultsList__resultsList___3yIIM.flix-grid') #'ResultsList_resultsList_3yIIM', div[class*="ResultsList"], 'div[class*=SearchResultShop]'
    flixbus = []
    for route in connections:
        departure_time = route.find('.LocationsHorizontal__time___TRSyU.LocationsHorizontal__departureTime___1_wvV').text #.flix-grid .flix-col-8
        flixbus_dict = {
            'departure_time': departure_time
        }
        flixbus.append(flixbus_dict)
    return flixbus

print(flixbus_scrape('Berlin', 'Hamburg', '22.05.2021'))
#<div class="flix-col-9 SearchResultShop__leftPart___2eO43"><div class="SearchResultShop__topPart___zpM4k SearchResultShop__messageOffset___-JLhI"><div class="LocationsHorizontal__schedule___qsiEQ"><div class="flix-grid"><div class="flix-col-8"><div class="LocationsHorizontal__leftPartTime___1ZjNr"><div class="LocationsHorizontal__time___TRSyU LocationsHorizontal__departureTime___1_wvV" data-e2e="search-result-departure-time">02:10</div><div class="LocationsHorizontal__duration___pvOr1"><span class="LocationsHorizontal__durationTime___2dPM4"><span data-e2e="search-result-duration">3:55 </span>hod</span></div></div></div><div class="flix-col-4"><div class="LocationsHorizontal__time___TRSyU undefined" data-e2e="search-result-departure-time">06:05</div></div></div></div><div class="LocationsHorizontal__stations___1Kytj"><div class="flix-grid"><div class="flix-col-8"><div class="LocationsHorizontal__station___SNp7r">Berlin,,Flughafen BER T1/2</div></div><div class="flix-col-4"><div class="LocationsHorizontal__station___SNp7r">Hamburg,,ZOB</div></div></div></div></div><div class="SearchResultShop__bottomPart___1wGdJ"><div class="flix-grid"><div class="flix-col-5 SearchResultShop__transfer___2rRuQ"><div class="TransferInfoComponentShop__changesInfo___2A7TU undefined"><div class="TransferInfoComponentShop__meansOfTransport___2x83T"><div class="TransferInfoComponentShop__circleIcon___3D6PF"><i class="flix-icon flix-icon--sm flix-icon-bus Icon__padless___1SbcS"></i></div></div><div class="TransferInfoComponentShop__timeInfo___2TbvV">bez přestupu</div><div class="TransferInfoComponentShop__infoButtonContainer___38PPE undefined"><i class="flix-icon flix-icon--sm flix-icon-arrow-down Icon__padless___1SbcS TransferInfoComponentShop__collapsed___2F7Ty"></i></div></div></div><div class="flix-col-7"><div class="SearchResultShop__uspsAndCapacity___2824f"><div role="none" class="Usps__uspIconContainers___3lGi6"><span class="Tooltip__wrap___1RVmL "><button class="Tooltip__trigger___NuEp4 PlainButton__btn___3og5J" type="button"><span class="hcr-icon-2-3-0-alpha-1 Usps__icon___1-dTB"><svg class="hcr-svg-wifi" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 1000 1000"><title>Wi-Fi zdarma</title><path d="M428.6 668.2A101.1 101.1 0 1 0 571.5 668.2 101.3 101.3 0 0 0 428.6 668.2ZM541.7 781.2H541.7A58 58 0 0 1 500.2 798.4H500.2A58.7 58.7 0 1 1 541.9 781.2ZM910.5 359H910.5A21.2 21.2 0 0 1 880.7 359 534.5 534.5 0 0 0 500 201.6H500A534.5 534.5 0 0 0 119.4 359 21.7 21.7 0 0 1 89.5 359 21.2 21.2 0 0 1 89.5 329.1 581.4 581.4 0 0 1 910.6 329.1 21.3 21.3 0 0 1 910.5 359ZM684.5 555.2A21.3 21.3 0 0 1 684.5 585.1 21.9 21.9 0 0 1 654.6 585.1 218.7 218.7 0 0 0 345.4 585.1 21.2 21.2 0 0 1 315.5 585.1 21.3 21.3 0 0 1 315.5 555.2 261.4 261.4 0 0 1 684.6 555.2ZM797.5 442.2A21.3 21.3 0 0 1 797.5 472 21.8 21.8 0 0 1 767.7 472 375.8 375.8 0 0 0 500 361.4H500A375.6 375.6 0 0 0 232.4 472 21.1 21.1 0 0 1 202.5 442.2 421.4 421.4 0 0 1 797.5 442.2Z"></path></svg></span><span class="hcr-icon-2-3-0-alpha-1 Usps__icon___1-dTB"><svg class="hcr-svg-socket" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 1000 1000"><title>Zásuvky</title><path d="M113.4 917.2L82.8 886.6 253.2 716.2A298.2 298.2 0 0 1 267.6 312.5L365.3 214.8A80.2 80.2 0 0 1 478.5 214.8L516 252.3 678 90.4A21.7 21.7 0 1 1 708.6 121L546.6 282.9 717.1 453.3 879.2 291.4A22.2 22.2 0 0 1 909.9 291.4H909.9A21.7 21.7 0 0 1 909.9 322L747.9 484 785.4 521.5A80.2 80.2 0 0 1 785.4 634.7L686.2 733.7A294 294 0 0 1 283.7 747ZM421.7 234.7A36.1 36.1 0 0 0 395.8 245.4L298.3 343.1A253.9 253.9 0 0 0 476.9 777H476.9A250.7 250.7 0 0 0 655.5 703.1L754.6 604.2A36.8 36.8 0 0 0 754.6 552.3L447.9 245.4A36.6 36.6 0 0 0 421.9 234.7Z"></path></svg></span><span class="hcr-icon-2-3-0-alpha-1 Usps__icon___1-dTB"><svg class="hcr-svg-anti-virus" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 1000 1000"><title>Pravidelně dezinfikováno</title><path d="M500 839.7A249.7 249.7 0 0 0 535.7 857C535.3 857.5 535.1 858.2 534.7 858.8A1080.6 1080.6 0 0 1 440.2 911.5 50 50 0 0 1 395.8 911.5C322.6 875.5 83.3 745.8 83.3 585.5V154.5A15.4 15.4 0 0 1 98.8 139.1 16.3 16.3 0 0 1 103.7 139.8 324 324 0 0 0 207.4 156.9 323.6 323.6 0 0 0 408.5 86.7 15.4 15.4 0 0 1 418.1 83.3 15.7 15.7 0 0 1 427.8 86.7 323.7 323.7 0 0 0 629.2 156.9 324.7 324.7 0 0 0 732.8 139.8 16.4 16.4 0 0 1 737.7 139.1 15.4 15.4 0 0 1 753.2 154.5V410.1L753 410.3A247.1 247.1 0 0 0 717.3 393 62.3 62.3 0 0 0 711.5 309.1V189.2A366.4 366.4 0 0 1 629.2 198.5 366.7 366.7 0 0 1 418.4 131.5 366.7 366.7 0 0 1 207.6 198.6 365.6 365.6 0 0 1 125 189.2V585.5C125 693.9 274.4 805.5 414.3 874A8.3 8.3 0 0 0 422 874L424.1 873A61.2 61.2 0 0 0 439 875 62.1 62.1 0 0 0 483.2 856.7ZM562.5 625A41.7 41.7 0 1 0 604.2 666.7 41.7 41.7 0 0 0 562.5 625ZM916.7 583.3V666.7A20.8 20.8 0 0 1 875 666.7V645.8H831.2A206.1 206.1 0 0 1 785.6 756.2L827.3 797.8A20.8 20.8 0 0 1 797.8 827.3H7